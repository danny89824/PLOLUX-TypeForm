<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡œì íŠ¸ ì˜ë¢° | PLOLUX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.15) 0px, transparent 50%), 
                        radial-gradient(at 100% 100%, rgba(168, 85, 247, 0.15) 0px, transparent 50%), 
                        #F8FAFC;
        }
        .step-container {
            transition: all 0.4s ease-in-out;
            opacity: 0;
            transform: translateY(20px);
            display: none;
            width: 100%; 
        }
        .step-container.active {
            opacity: 1;
            transform: translateY(0);
            display: block;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.01);
        }
        /* ì—ëŸ¬ ë°œìƒ ì‹œ í”ë“¤ë¦¼ ì• ë‹ˆë©”ì´ì…˜ */
        .shake {
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="glass-card w-full max-w-2xl rounded-3xl overflow-hidden relative shadow-2xl">
        
        <div class="h-1.5 bg-slate-100 w-full relative">
            <div id="progressBar" class="absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-500 ease-out" style="width: 25%;"></div>
        </div>
        
        <div class="pt-8 px-8 sm:px-10 pb-0">
            <span class="text-xl font-bold text-slate-900 tracking-tight">PLOLUX</span>
        </div>

        <form id="wizardForm" class="p-8 sm:p-10 pt-6">
            
            <div class="step-container active" data-step="1">
                <span class="text-xs font-bold text-indigo-600 tracking-wider uppercase mb-3 block">Step 1 / 4</span>
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-8 leading-tight">ì–´ë–¤ í”„ë¡œì íŠ¸ë¥¼<br>ê³„íší•˜ê³  ê³„ì‹ ê°€ìš”?</h2>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="relative">
                        <input type="radio" name="project_type" id="type_new" value="ì‹ ê·œêµ¬ì¶•" class="peer hidden" required>
                        <label for="type_new" class="flex flex-col items-center p-6 bg-white border-2 border-slate-100 rounded-2xl cursor-pointer transition-all hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50/50 peer-checked:ring-4 peer-checked:ring-indigo-100 group">
                            <div class="w-14 h-14 rounded-full bg-slate-50 text-3xl flex items-center justify-center mb-4 transition-colors group-hover:bg-indigo-100 peer-checked:bg-indigo-100">âœ¨</div>
                            <span class="font-bold text-slate-700 peer-checked:text-indigo-900">ì‹ ê·œ êµ¬ì¶•</span>
                            <span class="text-xs text-slate-400 mt-1">ìƒˆë¡œìš´ ë¸Œëœë“œë¥¼ ëŸ°ì¹­í•´ìš”</span>
                        </label>
                    </div>
                    <div class="relative">
                        <input type="radio" name="project_type" id="type_renewal" value="ë¦¬ë‰´ì–¼" class="peer hidden">
                        <label for="type_renewal" class="flex flex-col items-center p-6 bg-white border-2 border-slate-100 rounded-2xl cursor-pointer transition-all hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50/50 peer-checked:ring-4 peer-checked:ring-indigo-100 group">
                            <div class="w-14 h-14 rounded-full bg-slate-50 text-3xl flex items-center justify-center mb-4 transition-colors group-hover:bg-purple-100 peer-checked:bg-purple-100">ğŸ”„</div>
                            <span class="font-bold text-slate-700 peer-checked:text-indigo-900">ë¦¬ë‰´ì–¼</span>
                            <span class="text-xs text-slate-400 mt-1">ê¸°ì¡´ ì‚¬ì´íŠ¸ë¥¼ ê°œì„ í•´ìš”</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="step-container" data-step="2">
                <span class="text-xs font-bold text-indigo-600 tracking-wider uppercase mb-3 block">Step 2 / 4</span>
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">ìƒê°í•˜ì‹œëŠ” ì˜ˆì‚° ë²”ìœ„ëŠ”<br>ì–´ë–»ê²Œ ë˜ì‹œë‚˜ìš”?</h2>
                <p class="text-slate-500 mb-8 text-sm">í˜„ì‹¤ì ì¸ ê²¬ì  ì‚°ì¶œì„ ìœ„í•´ í•„ìš”í•œ ì •ë³´ì…ë‹ˆë‹¤.</p>

                <div class="space-y-3">
                    <div class="relative">
                        <input type="radio" name="budget" id="budget_small" value="500ë§Œì› ë¯¸ë§Œ" class="peer hidden" required>
                        <label for="budget_small" class="flex items-center w-full p-4 bg-white border-2 border-slate-100 rounded-xl cursor-pointer transition-all hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50/30 peer-checked:ring-2 peer-checked:ring-indigo-100">
                            <div class="w-5 h-5 rounded-full border-2 border-slate-300 mr-4 flex items-center justify-center peer-checked:border-indigo-600 peer-checked:bg-indigo-600">
                                <div class="w-2 h-2 rounded-full bg-white opacity-0 peer-checked:opacity-100"></div>
                            </div>
                            <span class="font-medium text-slate-700 peer-checked:text-indigo-900">500ë§Œì› ë¯¸ë§Œ (Basic)</span>
                        </label>
                    </div>
                    <div class="relative">
                        <input type="radio" name="budget" id="budget_medium" value="500~1500ë§Œì›" class="peer hidden">
                        <label for="budget_medium" class="flex items-center w-full p-4 bg-white border-2 border-slate-100 rounded-xl cursor-pointer transition-all hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50/30 peer-checked:ring-2 peer-checked:ring-indigo-100">
                            <div class="w-5 h-5 rounded-full border-2 border-slate-300 mr-4 flex items-center justify-center peer-checked:border-indigo-600 peer-checked:bg-indigo-600">
                                <div class="w-2 h-2 rounded-full bg-white opacity-0 peer-checked:opacity-100"></div>
                            </div>
                            <span class="font-medium text-slate-700 peer-checked:text-indigo-900">500ë§Œì› ~ 1,500ë§Œì› (Standard)</span>
                        </label>
                    </div>
                    <div class="relative">
                        <input type="radio" name="budget" id="budget_large" value="1500ë§Œì› ì´ìƒ" class="peer hidden">
                        <label for="budget_large" class="flex items-center w-full p-4 bg-white border-2 border-slate-100 rounded-xl cursor-pointer transition-all hover:border-indigo-200 peer-checked:border-indigo-600 peer-checked:bg-indigo-50/30 peer-checked:ring-2 peer-checked:ring-indigo-100">
                            <div class="w-5 h-5 rounded-full border-2 border-slate-300 mr-4 flex items-center justify-center peer-checked:border-indigo-600 peer-checked:bg-indigo-600">
                                <div class="w-2 h-2 rounded-full bg-white opacity-0 peer-checked:opacity-100"></div>
                            </div>
                            <span class="font-medium text-slate-700 peer-checked:text-indigo-900">1,500ë§Œì› ì´ìƒ (Premium)</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="step-container" data-step="3">
                <span class="text-xs font-bold text-indigo-600 tracking-wider uppercase mb-3 block">Step 3 / 4</span>
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-8">ì—°ë½ë°›ìœ¼ì‹¤ ì •ë³´ë¥¼<br>ì•Œë ¤ì£¼ì„¸ìš”.</h2>
                
                <div class="space-y-5">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">íšŒì‚¬/ë¸Œëœë“œëª… <span class="text-indigo-500">*</span></label>
                        <input type="text" name="company_name" required class="w-full px-5 py-4 rounded-xl border-2 border-slate-100 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all text-slate-800 bg-white" placeholder="ì˜ˆ: ì£¼ì‹íšŒì‚¬ í”Œë¡œëŸ­ìŠ¤">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">ì—°ë½ì²˜ (ì´ë©”ì¼/ì „í™”ë²ˆí˜¸) <span class="text-indigo-500">*</span></label>
                        <input type="text" name="contact" required class="w-full px-5 py-4 rounded-xl border-2 border-slate-100 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all text-slate-800 bg-white" placeholder="ì´ë©”ì¼ ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”">
                    </div>
                </div>
            </div>

             <div class="step-container" data-step="4">
                <span class="text-xs font-bold text-indigo-600 tracking-wider uppercase mb-3 block">Step 4 / 4</span>
                <h2 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-4">ê±°ì˜ ë‹¤ ë˜ì—ˆìŠµë‹ˆë‹¤!</h2>
                <p class="text-slate-600 mb-8 leading-relaxed">
                    ì‘ì„±í•´ì£¼ì‹  ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ<br>ë‹´ë‹¹ìê°€ ë¹ ë¥´ê²Œ ê²€í†  í›„ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.
                </p>
                 <div>
                    <label class="block text-sm font-semibold text-slate-700 mb-2">ì¶”ê°€ ìš”ì²­ì‚¬í•­ (ì„ íƒ)</label>
                    <textarea name="memo" rows="4" class="w-full px-5 py-4 rounded-xl border-2 border-slate-100 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all text-slate-800 bg-white resize-none" placeholder="ê¶ê¸ˆí•œ ì ì´ë‚˜ íŠ¹ë³„íˆ ì‹ ê²½ ì¨ì•¼ í•  ë¶€ë¶„ì´ ìˆë‹¤ë©´ ì ì–´ì£¼ì„¸ìš”."></textarea>
                </div>
            </div>


            <div class="mt-12 flex justify-between items-center pt-6 border-t border-slate-100/50">
                <button type="button" id="prevBtn" class="px-6 py-3 rounded-xl text-slate-500 font-semibold hover:bg-slate-50 hover:text-slate-700 transition-all hidden">
                    â† ì´ì „
                </button>
                
                <button type="button" id="nextBtn" class="ml-auto px-8 py-3.5 rounded-xl bg-indigo-600 text-white font-bold hover:bg-indigo-700 hover:shadow-lg hover:shadow-indigo-500/30 transition-all active:transform active:scale-95 flex items-center gap-2">
                    <span>ë‹¤ìŒ ë‹¨ê³„</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>
                </button>
            </div>

        </form>
    </div>

    <script>
        // âœ… Webhook URL
        const WEBHOOK_URL = 'https://recommand.app.n8n.cloud/webhook-test/1dd838ad-6b05-4a70-a16d-36d360bf3f0f';

        let currentStep = 1;
        const totalSteps = 4;
        const form = document.getElementById('wizardForm');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        const progressBar = document.getElementById('progressBar');
        const stepContainers = document.querySelectorAll('.step-container');

        // [ì‹œë‚˜ë¦¬ì˜¤ 1] ì´ˆê¸°í™”
        updateUI();

        // [ì‹œë‚˜ë¦¬ì˜¤ 2] ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
        nextBtn.addEventListener('click', handleNext);
        prevBtn.addEventListener('click', handlePrev);
        
        // [ì‹œë‚˜ë¦¬ì˜¤ 3] Enterí‚¤ë¡œ ë‹¤ìŒ ì´ë™ (Textarea ì œì™¸)
        form.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault(); // í¼ ê¸°ë³¸ ì œì¶œ ë°©ì§€
                handleNext();
            }
        });

        // âŒ [ì‚­ì œë¨] ë¼ë””ì˜¤ ë²„íŠ¼ ìë™ ë„˜ê¹€ ê¸°ëŠ¥ ì œê±°

        function handleNext() {
            if (currentStep < totalSteps) {
                // ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ ì¤‘ë‹¨
                if (!validateStep(currentStep)) return;
                
                currentStep++;
                updateUI();
            } else {
                // ë§ˆì§€ë§‰ ë‹¨ê³„ë©´ ì œì¶œ
                submitForm();
            }
        }

        function handlePrev() {
            if (currentStep > 1) {
                currentStep--;
                updateUI();
            }
        }

        // ìœ íš¨ì„± ê²€ì‚¬
        function validateStep(step) {
            const stepEl = document.querySelector(`.step-container[data-step="${step}"]`);
            
            // 1. í•„ìˆ˜ ë¼ë””ì˜¤ ë²„íŠ¼ ê·¸ë£¹ ê²€ì‚¬
            const radioGroups = new Set();
            stepEl.querySelectorAll('input[type="radio"][required]').forEach(r => radioGroups.add(r.name));
            
            for (const groupName of radioGroups) {
                const group = stepEl.querySelectorAll(`input[name="${groupName}"]`);
                const isChecked = [...group].some(radio => radio.checked);
                if (!isChecked) {
                    triggerShake(stepEl);
                    alert('í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return false;
                }
            }

            // 2. í•„ìˆ˜ í…ìŠ¤íŠ¸ ì¸í’‹ ê²€ì‚¬
            const textInputs = stepEl.querySelectorAll('input[type="text"][required], select[required]');
            let isTextValid = true;

            textInputs.forEach(input => {
                if (!input.value.trim()) {
                    isTextValid = false;
                    input.classList.add('border-red-500', 'ring-2', 'ring-red-500/20');
                    input.addEventListener('input', () => {
                        input.classList.remove('border-red-500', 'ring-2', 'ring-red-500/20');
                    }, { once: true });
                }
            });

            if (!isTextValid) {
                triggerShake(stepEl);
                return false;
            }

            return true;
        }

        // ì—ëŸ¬ ì‹œ í”ë“¤ë¦¼ íš¨ê³¼
        function triggerShake(element) {
            element.classList.remove('shake');
            void element.offsetWidth; 
            element.classList.add('shake');
        }

        function updateUI() {
            // ë‹¨ê³„ í‘œì‹œ
            stepContainers.forEach(step => {
                const stepNum = parseInt(step.dataset.step);
                if (stepNum === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });

            // í”„ë¡œê·¸ë ˆìŠ¤ ë°”
            const progress = (currentStep / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;

            // ë²„íŠ¼ ìƒíƒœ
            prevBtn.style.display = currentStep === 1 ? 'none' : 'block';
            
            if (currentStep === totalSteps) {
                nextBtn.innerHTML = '<span>ì œì¶œí•˜ê¸°</span><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>';
            } else {
                nextBtn.innerHTML = '<span>ë‹¤ìŒ ë‹¨ê³„</span><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>';
            }
        }

        // í¼ ì œì¶œ
        async function submitForm() {
            nextBtn.disabled = true;
            const originalContent = nextBtn.innerHTML;
            nextBtn.innerHTML = '<div class="spinner"></div><span class="ml-2">ì „ì†¡ ì¤‘...</span>';
            nextBtn.classList.add('opacity-75', 'cursor-not-allowed');

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data),
                });

                if (response.ok) {
                    alert('âœ… ì˜ë¢°ê°€ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ê³§ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤!');
                    location.reload(); 
                } else {
                    throw new Error('Server returned ' + response.status);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('âŒ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (n8n Webhook Test ëª¨ë“œì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”)');
            } finally {
                nextBtn.disabled = false;
                nextBtn.innerHTML = originalContent;
                nextBtn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        }
    </script>
</body>
</html>
